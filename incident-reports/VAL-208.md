# Incident Report: VAL-208 â€“ Weak Password Requirements

## Summary
- Reporter: Security Team  
- Priority: Critical  
- Description: Password validation on signup only enforced an eight-character minimum (plus a client-only digit check). Attackers could create accounts with trivially guessable passwords, creating a major account-takeover risk.

## Impact
- Elevated probability of credential stuffing and brute-force success.
- Compliance exposure since password policy failed to meet basic complexity standards.

## Detection
- Security Team filed ticket VAL-208 after reviewing the onboarding form and noticing the lack of server-side complexity checks.

## Root Cause
1. `app/signup/page.tsx` only required eight characters and optionally a digit through client-side validation; uppercase, lowercase, and special characters were not enforced.
2. `authRouter.signup` accepted any `password: z.string().min(8)`, so even the weak client guard could be bypassed with a direct API call.

## Resolution
- Added shared helpers in `support-engineer-interview-main/lib/validation/password.ts` to determine whether a password is common and to produce an appropriate complexity error.
- Updated `app/signup/page.tsx` to import these helpers so React Hook Form now rejects common passwords and requires uppercase, lowercase, numeric, and special characters in addition to the 8-character minimum.
- Hardened the backend by introducing `passwordSchema` in `support-engineer-interview-main/server/routers/auth.ts`. The Zod schema mirrors the same rules, ensuring direct API usage cannot bypass complexity requirements.

## Verification
- Manual reasoning/tests: submitting a weak password (e.g., `password1`) now shows a descriptive validation error on the client and is also rejected by the API schema. Strong passwords meeting all requirements proceed normally.
- Suggested follow-up: add automated tests for `password.ts` helpers and TRPC router input validation to prevent regressions.

## Lessons Learned
1. Authentication and security-critical validations must exist on both client and server.
2. Encapsulating validation logic (e.g., shared helper modules) avoids drift and simplifies future policy changes.
3. Security review items should include automated checks or lint rules to enforce minimum complexity standards.
